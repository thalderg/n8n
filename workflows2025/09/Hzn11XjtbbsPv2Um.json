{
  "": "",
  "active": false,
  "connections": {
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram": {
      "main": [
        [
          {
            "node": "OpenAI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Calendar Manager",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI": {
      "main": [
        [
          {
            "node": "Calendar Manager",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Search Events": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Create Event": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Update Event": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Telegram1": {
      "main": [
        []
      ]
    },
    "Calendar Manager": {
      "main": [
        [
          {
            "node": "Telegram1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Memory": {
      "ai_memory": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Create Monthly Goal in Todoist": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Create Weekly Goal in Todoist": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Create Inbox Task in Todoist": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Get a task in Todoist": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Get many tasks in Todoist": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Update a Task in Todoist": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Delete a task in Todoist": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Close a task in Todoist": {
      "ai_tool": [
        [
          {
            "node": "Calendar Manager",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-09-27T09:53:45.635Z",
  "id": "Hzn11XjtbbsPv2Um",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Productivity Manager",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.1,
      "position": [
        -608,
        128
      ],
      "id": "fab1070b-d642-406d-83e1-9202c5fa8645",
      "name": "Telegram Trigger",
      "webhookId": "1105bce1-0ea8-4b50-a87c-f0d0e839d2ed",
      "credentials": {
        "telegramApi": {
          "id": "CtMYqp19WyE0XY9E",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.message.text }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "exists",
                      "singleValue": true
                    },
                    "id": "ff5e1442-1f1a-412e-8b15-437d9cf3b58b"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "text"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "a6d6da92-8272-4f6f-97be-7b733fc5b6d2",
                    "leftValue": "={{ $json.message.voice.file_id }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "exists",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "voice"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -416,
        128
      ],
      "id": "a0fc23e9-f16a-4351-8076-a66b4c46bade",
      "name": "Switch"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "13f27e1a-8d2b-4e19-afe4-ee282c5098a7",
              "name": "=text",
              "value": "={{ $json.message.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -176,
        32
      ],
      "id": "e2b62b2c-7254-4031-8257-a8f0273db9dc",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "resource": "file",
        "fileId": "={{ $json.message.voice.file_id }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -192,
        272
      ],
      "id": "cd145f72-9e0a-474f-bc75-49bff27116df",
      "name": "Telegram",
      "webhookId": "0848e745-ccfd-4203-98f0-154ea83bae8d",
      "credentials": {
        "telegramApi": {
          "id": "CtMYqp19WyE0XY9E",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        32,
        272
      ],
      "id": "c94631af-ca53-4aab-844c-9f674a0e18e1",
      "name": "OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "fcIDL6mBCr4eAnxg",
          "name": "OpenAi voice to text"
        }
      }
    },
    {
      "parameters": {
        "options": {
          "frequencyPenalty": 0.2,
          "maxTokens": 1800,
          "presencePenalty": 0,
          "temperature": 0.2,
          "timeout": 45000,
          "maxRetries": 3,
          "topP": 0.9
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.1,
      "position": [
        -96,
        512
      ],
      "id": "7c24b18a-c0bd-45c9-914c-bd28c44aad62",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "fcIDL6mBCr4eAnxg",
          "name": "OpenAi voice to text"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "={{ $json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        1072,
        176
      ],
      "id": "964c4342-d314-4991-b1b3-4762d818c3fb",
      "name": "Telegram1",
      "webhookId": "72ca9428-0d24-40e5-9428-c7087f0fa679",
      "credentials": {
        "telegramApi": {
          "id": "CtMYqp19WyE0XY9E",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "giopag81@gmail.com",
          "mode": "list",
          "cachedResultName": "giopag81@gmail.com"
        },
        "options": {
          "timeMin": "={{ $fromAI('StartDate','the start date and time for fetching events') }}",
          "timeMax": "={{ $fromAI('EndDate','the end date and time for fetching events') }}"
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.2,
      "position": [
        960,
        416
      ],
      "id": "5fa208a8-c19a-420e-996a-9b2cd7811143",
      "name": "Search Events",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "RDxm6PWdrRguEIuu",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Creates Google Calendar Events",
        "calendar": {
          "__rl": true,
          "value": "giopag81@gmail.com",
          "mode": "list",
          "cachedResultName": "giopag81@gmail.com"
        },
        "start": "={{ $fromAI('StartDate','the start date and time for creating events') }}",
        "end": "={{ $fromAI('EndDate','the end date and time for creating events') }}",
        "additionalFields": {
          "summary": "={{ $fromAI('eventName','the name used for creating new events') }}"
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.2,
      "position": [
        1072,
        416
      ],
      "id": "5c06a7f7-f516-4165-bb13-1c29e950fe71",
      "name": "Create Event",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "RDxm6PWdrRguEIuu",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Update Google Calendar Event",
        "operation": "update",
        "calendar": {
          "__rl": true,
          "value": "giopag81@gmail.com",
          "mode": "list",
          "cachedResultName": "giopag81@gmail.com"
        },
        "eventId": "={{ $fromAI('eventID','the event ID of the event needing updated') }}",
        "updateFields": {
          "end": "={{ $fromAI('updatedEnd','the updated end time and day of the event') }}",
          "start": "={{ $fromAI('updatedStart','the updated start time and day of the event') }}",
          "summary": "={{ $fromAI('eventName','the updated name of the event') }}"
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.2,
      "position": [
        1184,
        416
      ],
      "id": "d7191ea2-9b86-4044-9355-dd4979ebebba",
      "name": "Update Event",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "RDxm6PWdrRguEIuu",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.text }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=<AgentInstructions>\n    <Role>\n        <Name>Productivity Manager</Name>\n        <Description>Manages calendar events and tasks with intelligent cross-system synchronization, visual goal tracking, and bidirectional conversions between Google Calendar and Todoist.</Description>\n        <currentDate>{{$now}}</currentDate>\n        \n        <!-- Cross-System Operations -->\n        <Instruction>\n            For synchronization requests: \"Block time for task\" → Get task + Check availability + Create event | \"Convert meeting to task\" → Get event + Create task | \"Event to task\" → Extract event info + Create Todoist task | \"Task to event\" → Extract task info + Create calendar event | Always confirm cross-system changes before execution.\n        </Instruction>\n        <Instruction>\n            CRITICAL: Always use actual tools - never simulate or describe actions:\n            • For task creation: MUST use \"Create Weekly Goal in Todoist\", \"Create Monthly Goal in Todoist\", or \"Create Inbox Task in Todoist\" tools\n            • For task updates: MUST use \"Update a Task in Todoist\" tool  \n            • For calendar events: MUST use \"Search Events\", \"Create Event\", \"Update Event\" tools\n            • Never respond with \"Created task\" or \"Updated event\" unless tool was actually executed\n            • get many and get action tools must also be always excecuted. \n            • If tool execution fails, report the error - do not pretend success\n            • Never use memory as a replacement for tools\n        </Instruction>\n    </Role>\n\n    <!-- Calendar Operations -->\n    <SubRole>\n        <Name>Calendar Event Manager</Name>\n        \n        <Instruction>New events: Use \"Search Events\" for conflicts → If conflicts exist, provide alternatives → If none, use \"Create Event\" immediately.</Instruction>\n        \n        <Instruction>Event updates: \"Search Events\" to find eventID → Confirm details → \"Update Event\" → Summarize changes.</Instruction>\n        \n        <Instruction>Event info: Parse dates as \"YYYY-MM-DD 00:00:00\" to \"YYYY-MM-DD 23:59:59\" → \"Search Events\" → Present concise list (time, title, participants).</Instruction>\n        \n        <Instruction>Event deletion: \"Search Events\" to find → Confirm with user → \"Delete Event\" → Confirm deletion.</Instruction>\n    </SubRole>\n\n    <!-- Task Operations -->\n    <SubRole>\n        <Name>Task Manager</Name>\n        \n        <Instruction>\n            Task creation: Determine project (Weekly Goals: ≤7 days, Monthly Goals: ≤30 days, Inbox: daily/immediate) → Use appropriate \"Create\" tool → Always provide fields:\n            • Label: [\"@work\", \"@urgent\"] (contextual labels)\n            • Content: \"🎯 Task title\" (with emoji: 🎯 objectives, 📈 metrics, 🏆 achievements, 🚀 projects, 💡 ideas, 📋 planning)\n            • Description: Detailed context and approach\n            • DueString: \"today\", \"tomorrow\", \"next Friday\" (natural language)\n            • Priority: 1-4 (1=🔴 urgent, 2=🟡 high, 3=🟢 medium, 4=⚪ low)\n        </Instruction>\n        \n        <Instruction>\n            Task updates: \"Get a task\" with TaskId OR \"Get many tasks\" with Project → For completion: \"Close a task\" with TaskId → For changes: \"Update a Task\" with TaskID + updated fields → Show status with ✅⏳⚠️📅 indicators.\n        </Instruction>\n        \n        <Instruction>Task info: \"Get many tasks\" with Project (\"Weekly Goals\", \"Monthly Goals\", \"Inbox\") → Present with visual indicators and priority levels.</Instruction>\n        \n        <Instruction>Task deletion: Find task via \"Get many tasks\" or \"Get a task\" → Confirm details → \"Delete a task\" with TaskId → Confirm deletion.</Instruction>\n    </SubRole>\n\n    <!-- Response Format -->\n        <Instruction>\n            Response sequence: 1) Execute tool first, 2) Then provide formatted response based on actual tool results\n            • Example: Use \"Create Weekly Goal in Todoist\" → THEN respond \"✅ Created task: 🎯 Complete certification\"\n            • Never provide success confirmation without actual tool execution\n            • If tool fails, explain the error and ask for clarification\n        </Instruction>\n\n    <!-- Tools Verification -->\n        <Instruction>\n            After each tool execution:\n            • Verify the tool returned success confirmation\n            • If tool returns error, troubleshoot or ask user for help\n            • Only confirm success if tool actually succeeded\n            • For task creation, mention the task ID if returned by tool\n        </Instruction>\n\n    <Safety>\n        Confirm before deleting | Ask for clarification on ambiguous requests | Show what will be created/modified before cross-system execution | Verify project existence before task creation.\n    </Safety>\n\n    <Goal>\n        <Primary>Handle calendar events, tasks, goal management, and seamless bidirectional synchronization through natural conversation with visual indicators.</Primary>\n    </Goal>\n\n    <Tools>\n        1) Search Events, 2) Create Event, 3) Update Event, 4) Create Weekly Goal in Todoist, 5) Create Inbox Task in Todoist, 6) Get a task in Todoist, 7) Delete a task in Todoist, 8) Create Monthly Goal in Todoist, 9) Update a Task in Todoist, 10) Get many tasks in Todoist, 11) Close a task in Todoist\n    </Tools>\n</AgentInstructions>"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        400,
        176
      ],
      "id": "fffaba39-1087-4fec-b360-67c103989123",
      "name": "Calendar Manager"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{$('Telegram Trigger').item.json.message.chat.id}}",
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        32,
        512
      ],
      "id": "d7e3a00c-8884-4b26-accf-f99046bf7c42",
      "name": "Memory"
    },
    {
      "parameters": {
        "project": {
          "__rl": true,
          "value": "2360779983",
          "mode": "list",
          "cachedResultName": "Monthly Goals"
        },
        "labels": "={{ $fromAI('Label','the label names of the task') }}",
        "content": "={{ $fromAI('Content','the content or objective details of the task') }}",
        "options": {
          "description": "={{ $fromAI('Description','A short description of the task') }}",
          "dueString": "={{ $fromAI('DueString','when the task is due') }}",
          "priority": "={{ $fromAI('Priority','the priority of the task from 1 to 4') }}"
        }
      },
      "type": "n8n-nodes-base.todoistTool",
      "typeVersion": 2.1,
      "position": [
        272,
        592
      ],
      "id": "5c53824f-fa7c-44c9-9a73-51b23cfd6d70",
      "name": "Create Monthly Goal in Todoist",
      "credentials": {
        "todoistApi": {
          "id": "0e5FBGaHXik0sBQC",
          "name": "Todoist account"
        }
      }
    },
    {
      "parameters": {
        "project": {
          "__rl": true,
          "value": "2360780016",
          "mode": "list",
          "cachedResultName": "Weekly Goals"
        },
        "labels": "={{ $fromAI('Label','the label names of the task') }}",
        "content": "={{ $fromAI('Content','the content or objective details of the task') }}",
        "options": {
          "description": "={{ $fromAI('Description','A short description of the task') }}",
          "dueString": "={{ $fromAI('DueString','when the task is due') }}",
          "priority": "={{ $fromAI('Priority','the priority of the task from 1 to 4') }}"
        }
      },
      "type": "n8n-nodes-base.todoistTool",
      "typeVersion": 2.1,
      "position": [
        176,
        464
      ],
      "id": "88df4287-db1f-42cc-8038-a4b0445931f6",
      "name": "Create Weekly Goal in Todoist",
      "credentials": {
        "todoistApi": {
          "id": "0e5FBGaHXik0sBQC",
          "name": "Todoist account"
        }
      }
    },
    {
      "parameters": {
        "project": {
          "__rl": true,
          "value": "2360667327",
          "mode": "list",
          "cachedResultName": "Inbox"
        },
        "labels": "={{ $fromAI('Label','the label names of the task') }}",
        "content": "={{ $fromAI('Content','the content or objective details of the task') }}",
        "options": {
          "description": "={{ $fromAI('Description','A short description of the task') }}",
          "dueString": "={{ $fromAI('DueString','when the task is due') }}",
          "priority": "={{ $fromAI('Priority','the priority of the task from 1 to 4') }}"
        }
      },
      "type": "n8n-nodes-base.todoistTool",
      "typeVersion": 2.1,
      "position": [
        368,
        464
      ],
      "id": "d127fee4-6d3d-4f85-9cbe-f2a5e135f958",
      "name": "Create Inbox Task in Todoist",
      "credentials": {
        "todoistApi": {
          "id": "0e5FBGaHXik0sBQC",
          "name": "Todoist account"
        }
      }
    },
    {
      "parameters": {
        "operation": "get",
        "taskId": "={{ $fromAI('TaskId', 'The ID of the task to retrieve') }}"
      },
      "type": "n8n-nodes-base.todoistTool",
      "typeVersion": 2.1,
      "position": [
        576,
        464
      ],
      "id": "b08c91de-14d6-4864-8e9c-008c88ef1e67",
      "name": "Get a task in Todoist",
      "credentials": {
        "todoistApi": {
          "id": "0e5FBGaHXik0sBQC",
          "name": "Todoist account"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "filters": {
          "projectId": "={{ $fromAI('Project', 'the name of the project to search from') }}"
        }
      },
      "type": "n8n-nodes-base.todoistTool",
      "typeVersion": 2.1,
      "position": [
        656,
        576
      ],
      "id": "b0faa33e-bb40-4afb-8ff1-8c33f44cbcc8",
      "name": "Get many tasks in Todoist",
      "credentials": {
        "todoistApi": {
          "id": "0e5FBGaHXik0sBQC",
          "name": "Todoist account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "taskId": "={{ $fromAI ('TaskID', 'The ID of the task to update') }}",
        "updateFields": {
          "content": "={{ $fromAI('Content','the content or objective details of the task') }}",
          "description": "={{ $fromAI('Description','A short description of the task') }}",
          "dueString": "={{ $fromAI('DueString','when the task is due') }}",
          "labels": "={{ $fromAI('Label','the label name of the task') }}",
          "priority": "={{ $fromAI('Priority','the priority of the task from 1 to 4') }}"
        }
      },
      "type": "n8n-nodes-base.todoistTool",
      "typeVersion": 2.1,
      "position": [
        480,
        576
      ],
      "id": "ea13be5c-6672-4534-b412-de70c9706aa4",
      "name": "Update a Task in Todoist",
      "credentials": {
        "todoistApi": {
          "id": "0e5FBGaHXik0sBQC",
          "name": "Todoist account"
        }
      }
    },
    {
      "parameters": {
        "operation": "delete",
        "taskId": "={{ $fromAI('TaskId', 'The ID of the task to delete') }}"
      },
      "type": "n8n-nodes-base.todoistTool",
      "typeVersion": 2.1,
      "position": [
        736,
        464
      ],
      "id": "b0e48d73-dab8-4e22-a584-a09951960d85",
      "name": "Delete a task in Todoist",
      "credentials": {
        "todoistApi": {
          "id": "0e5FBGaHXik0sBQC",
          "name": "Todoist account"
        }
      }
    },
    {
      "parameters": {
        "operation": "close",
        "taskId": "={{ $fromAI('TaskId', 'The ID of the task to close') }}"
      },
      "type": "n8n-nodes-base.todoistTool",
      "typeVersion": 2.1,
      "position": [
        832,
        560
      ],
      "id": "8f394cd3-1335-4752-a319-367fce92018d",
      "name": "Close a task in Todoist",
      "credentials": {
        "todoistApi": {
          "id": "0e5FBGaHXik0sBQC",
          "name": "Todoist account"
        }
      }
    }
  ],
  "pinData": {},
  "repo_name": "n8n",
  "repo_owner": "thalderg",
  "repo_path": "workflows",
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "createdAt": "2025-09-27T09:53:45.641Z",
      "updatedAt": "2025-09-27T09:53:45.641Z",
      "role": "workflow:owner",
      "workflowId": "Hzn11XjtbbsPv2Um",
      "projectId": "rwZmgF8pMPgWdXwq"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-09-29T16:45:22.000Z",
  "versionId": "f87b554f-42ef-4eda-9cb8-24af6dd44a7a"
}